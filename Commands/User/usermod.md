# usermod
## 1. 名称
`usermod` - 修改用户的账户信息(modify a user account)

## 2. 语法
`usermod [选项] 用户名`

## 3. 描述
`usermod`命令用来修改系统中的用户账号信息, 此命令是通过修改系统中保存用户信息的文件来实现修改用户信息的.

## 3. 选项
* -a, --append
  - 将`用户`添加到指定的`用户组`中, 必须和`-G`一起使用
* -c, --comment 备注信息
  - 修改用户密码对应的备注信息. 一般情况下使用`chfn`命令去修改这些备注信息.
* -d, --home home路径
  - 修改用户登录后的`home`
  - 如果同时使用了`-m`选项, 当前用户的`home`会被移动到新的`home`路径下. 如果新的home不存在时会自动创建.
* -e, --expiredate 时间
  - 设置账号的过期时间, 这个`时间`的格式为: `YYYY-MM-DD`.
  - 如果`时间`参数为空, 将会取消用户的过期状态.
  - 这个选项会将过期时间保存在`/etc/shadow`文件中, 如果文件不存在会自动创建.
* -f, --inactive 天数
  - 设置`天数`, 当账号密码过期后的指定天数后账号永久失效.
  - 如果`天数`被设置为0, 密码过期后立刻禁用账号. 如果值为-1, 将关闭禁用账号的功能.
  - 这个选项会将过期时间保存在`/etc/shadow`文件中, 如果文件不存在会自动创建.
* -g, --gid group名称/group id
  - 通过`group名称`或者`id`设置账号的登录时候的组.
  - 用户home目录下的任何所属组是当前group name的文件都会被设置到新的组中.
  - 在home目录之外的所有所属组为当前group name的文件需要手动去设置到新的组中.
* -G, groups group1[,group2,...,groupn]
  - 修改账户所属的组, 每个group name通过逗号分隔, 中间不能有空格.
  - 这些组和使用选项`-g`的组有同样的限制条件.
  - 如果账号当前所在的组没有被列在参数中的话, 用户将被从这个组中移除. 这种情况可以通过`-a`选项避免, 通过`-a`来实现将账号新增到指定的组中.
* -l, --login 新的登录用户名
  - 将账号的登录名从原来的名称改为新的登录用户名, 除此之外不改变其他的名称. 用户的home名称需要通过手动去修改来实现和登录用户名一致.
* -L, --lock
  - 锁定账户的密码, 通过在加密的密码前面添加`!`的方式实现. 这个参数不能和`-p`, `-U`一起使用.
* -m, --move-home
  - 移动用户home路径下的所有内容到新路径下. 
  - **这个选项只有和`-d/--home`一起使用时, 才有效.**
* -p, --password 密码
  - 修改账户密码. **不建议通过这种方式修改密码, 因为其他用户可以通过查看进程的方式看到新修改的密码.**
  - 新密码会被写入`/etc/passwd`或者`/etc/shadow`文件中. 如果修改了`PAM`配置, 那么保存的位置以配置内容为准.
  - 密码必须符合系统的格式要求.
* -s, --shell shell程序名
  - 修改用户的登录shell. 如果`shell程序名`为空, 系统会使用默认的shell.
* -u, --uid userid
  - 为账户设置新的uid为userid. 这个新的uid必须是唯一的, 并且不能是负数.
  - 任何所属用户是当前uid的文件都会自动将所属用户修改为新的userid.
* -U, --unlock
  - 解锁用户的密码, 这个选项将会移除账户密码前面的`!`.

## 5. 注意
- `usermod`命令不允许你改变正在线上的使用者帐号名称.

## 6. 相关配置
以下的配置参数都保存在`/etc/login.defs`文件中.  
* `MAIL_DIR` (string)
  - 系统邮件的保存位置.  
* `MAX_MEMBERS_PER_GROUP` (number)
  - 每组最多可容纳的用户数量. 默认是0, 表示没有上限.  

## 7. 相关文件
* `/etc/group`
  - 保存组信息的文件  
* `/etc/login.defs`
  - 用户, 密码配置信息保存的文件  
* `/etc/passwd`
  - 保存账号信息的文件  
* `/etc/shadow`
  - 保存账号信息的文件, 去除了密码的部分.

## 8. 示例
```shell
usermod -G staff newuser2 
usermod -l newuser1 newuser 
usermod -L newuser1 
usermod -U newuser1
usermod -e 01/01/2013 test
usermod -G staff newuser2
```
